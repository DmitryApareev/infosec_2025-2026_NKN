# Отчёт по лабораторной работе №4
## Защита данных сегмента АСУ ТП

**Выполнили:**  
Апареев Д.А  
Игнатенкова В.Н.  
Демидович Н.М.  
Ендонова А.В.  
Машковцева К.С.  
Шубнякова Д.И.

---

## Содержание
1. [Цель работы](#цель-работы)
2. [Задание](#задание)
3. [Теоретическое введение](#теоретическое-введение)
4. [Выполнение лабораторной работы](#выполнение-лабораторной-работы)
5. [Выводы](#выводы)
6. [Список литературы](#список-литературы)

---

## 1. Цель работы

Целью данной лабораторной работы является освоение практических навыков выявления, анализа и устранения уязвимостей информационных систем, а также последствий компьютерных атак на критически важный сегмент предприятия — автоматизированные системы управления технологическим процессом (АСУ ТП).

## 2. Задание

- Обнаружить, проанализировать и закрыть уязвимости:
  1. Уязвимая версия Apache Axis2 (CVE-2010-0219)
  2. Уязвимая версия программы CoolReaderPDF (CVE-2012-4914)
  3. Уязвимая версия IGSS (CVE-2011-1567)

- Определить и устранить последствия эксплуатации уязвимостей:
  1. App Backdoor (последствие уязвимости 1)
  2. Manager meterpreter-сессия (последствие уязвимости 2)
  3. IGSS meterpreter-сессия (последствие уязвимости 3)

- Разработать и применить меры по устранению выявленных уязвимостей и их последствий.

## 3. Теоретическое введение

**VipNet IDS (Intrusion Detection System)** — система обнаружения вторжений, предназначенная для мониторинга сетевого трафика, выявления подозрительной активности и генерации оповещений о потенциальных атаках.

**VipNet TIAS (Threat Intelligence Analytics System)** — аналитическая система для автоматического выявления инцидентов информационной безопасности на основе интеллектуального анализа событий.

**Security Onion** — дистрибутив для мониторинга сетевой безопасности, включающий инструменты Snort, Suricata, Zeek, OSSEC, Squil, Squert и Elastic Stack.

**АСУ ТП** — автоматизированные системы управления технологическим процессом.

**Уязвимость CVE-2010-0219 (Apache Axis2)** — наличие учетной записи администратора по умолчанию (admin/axis2), позволяющее загрузить и выполнить произвольный вредоносный веб-сервис.

**Уязвимость CVE-2012-4914 (CoolReaderPDF)** — переполнение стека при открытии специально сгенерированного PDF-документа.

**Уязвимость CVE-2011-1567 (IGSS)** — переполнение стека в программе IGSSdataServer.exe при выполнении операции ListAll.

**Meterpreter** — полезная нагрузка фреймворка Metasploit, предоставляющая расширенный контроль над скомпрометированной системой.

## 4. Выполнение лабораторной работы

### 4.1 Обнаружение уязвимостей и последствий

#### 4.1.1 Обнаружение уязвимости "Уязвимая версия Axis2 (CVE-2010-0219)"

В журналах VipNet IDS NS зафиксировано событие с сигнатурой "AM POLICY Apache Axis2 v1.6 Default Admin Credential (CVE-2010-0219)", указывающее на попытку доступа к конфигурационному файлу `axis2.xml`.

![Событие в VipNet IDS NS](media/image1.png)

*Рисунок 1: Событие в VipNet IDS NS о попытке эксплуатации уязвимости Axis2*

Анализ в VipNet TIAS подтвердил данное событие как подозрительное.

*Рисунок 2: Подтверждение инцидента в VipNet TIAS*

#### 4.1.2 Обнаружение последствия "App Backdoor"

После успешной эксплуатации уязвимости Axis2 нарушитель загрузил на сервер backdoor-файл. В VipNet IDS зафиксированы события, связанные с установлением обратного соединения (reverse shell).

Наличие backdoor подтверждается командой `ss -tp` и записью в журнале `/var/log/syslog` о автозапуске файла через cron.

*Рисунок 3: Обнаружение установленного соединения с нарушителем с помощью ss -tp*

*Рисунок 4: Запись об автозапуске backdoor в /var/log/syslog*

#### 4.1.3 Обнаружение уязвимости "Уязвимая версия CoolReaderPDF (CVE-2012-4914)"

В VipNet IDS зафиксированы события загрузки и передачи PDF-документа. Активация полезной нагрузки детектирована по событиям, связанным с установлением meterpreter-сессии.

*Рисунок 5: События в VipNet IDS, связанные с атакой на CoolReaderPDF*

#### 4.1.4 Обнаружение последствия "Manager meterpreter-сессия"

Факт установления сессии подтверждается с помощью утилиты `netstat -bno` в Windows.

*Рисунок 6: Обнаружение обратного соединения с нарушителем на Manager Workstation*

#### 4.1.5 Обнаружение уязвимости "Уязвимая версия IGSS (CVE-2011-1567)"

Атака на сервер АСУ ТП детектирована VipNet IDS по событиям сканирования порта 12401 и попытки эксплуатации уязвимости в IGSSdataServer.exe.

*Рисунок 7: События в VipNet IDS, связанные с атакой на IGSS*

#### 4.1.6 Обнаружение последствия "IGSS meterpreter-сессия"

На сервере АСУ ТП с помощью `netstat -bno` обнаружено установленное соединение с IP-адресом нарушителя.

*Рисунок 8: Обнаружение обратного соединения на SCADA Server*

### 4.2 Устранение уязвимостей и их последствий

#### 4.2.1 Устранение уязвимости "Уязвимая версия Axis2" и последствия "App Backdoor"

**Устранение последствия (App Backdoor):**
- Найден и удален файл backdoor (`evil.conf`) по пути `/opt/tomcat/webapps/`
- Удалена задача автозапуска из `/var/spool/cron/crontabs/tomcat`
- Завершены активные сессии командой `kill <PID>`

*Рисунок 9: Удаление задачи из crontab*

*Рисунок 10: Удаление файла backdoor*

**Устранение уязвимости (CVE-2010-0219):**
- Добавлено правило в iptables: `iptables -I INPUT 1 -j REJECT -p tcp --dport 8080 -m string --string "axis2.xml" --algo kmp`
- Обновление Axis2 до актуальной версии или остановка уязвимого приложения

*Рисунок 11: Добавление правила в iptables*

*Рисунок 12: Остановка приложения Axis2 в менеджере Tomcat*

#### 4.2.2 Устранение уязвимости "Уязвимая версия CoolReaderPDF" и последствия "Manager meterpreter-сессия"

**Устранение последствия (Manager meterpreter):**
- Завершен процесс командой `taskkill /f /pid <PID>`

*Рисунок 13: Завершение процесса meterpreter на Manager Workstation*

**Устранение уязвимости (CVE-2012-4914):**
- Обновление CoolReaderPDF до последней версии
- Настройка правила в брандмауэре, блокирующего исходящий трафик от приложения

#### 4.2.3 Устранение уязвимости "Уязвимая версия IGSS" и последствия "IGSS meterpreter-сессия"

**Устранение последствия (IGSS meterpreter):**
- Завершен процесс командой `taskkill /f /pid <PID>`

*Рисунок 14: Завершение процесса meterpreter на SCADA Server*

**Устранение уязвимости (CVE-2011-1567):**
- Включено и настроено исключение в Брандмауэре Windows
- Рекомендуется обновить ПО IGSS до защищенной версии

*Рисунок 15: Настройка Брандмауэра Windows для IGSS*

### 4.3 Результат

После выполнения мероприятий по устранению уязвимостей и их последствий в средствах мониторинга более не фиксируется подозрительная активность. Все backdoor-файлы удалены, установленные соединения разорваны, уязвимое ПО обновлено или защищено.

*Рисунок 16: Отсутствие активных инцидентов в VipNet TIAS после устранения*

*Рисунок 17: Подтверждение отсутствия вредоносных соединений с помощью netstat/ss*

## 5. Выводы

В ходе выполнения лабораторной работы успешно освоены практические навыки по защите сегмента АСУ ТП. Отработаны методы обнаружения сложных многоэтапных атак с использованием современных средств защиты (VipNet IDS NS, VipNet TIAS, Security Onion). Приобретен опыт анализа сетевого трафика, системных логов и процессов для выявления последствий атак. Разработаны и применены эффективные меры по устранению уязвимостей и нейтрализации активных угроз, что позволило восстановить безопасность критически важной инфраструктуры предприятия.

## 6. Список литературы

1. Common Vulnerabilities and Exposures (CVE) — CVE-2010-0219 [Электронный ресурс]
2. Common Vulnerabilities and Exposures (CVE) — CVE-2012-4914 [Электронный ресурс]
3. Common Vulnerabilities and Exposures (CVE) — CVE-2011-1567 [Электронный ресурс]
4. Программный комплекс обучения методам обнаружения, анализа и устранения последствий компьютерных атак "Ampire". Сценарий №4 «ЗАЩИТА ДАННЫХ СЕГМЕНТА АСУ ТП» [Электронный ресурс]
5. Официальная документация по VipNet IDS NS и VipNet TIAS [Электронный ресурс]
6. Официальный сайт и документация Security Onion [Электронный ресурс]